<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Electrochemistry System · Ai4EComponentLib.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://ai4energy.github.io/Ai4EComponentLib.jl/tutorials/Electrochemistry/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Ai4EComponentLib.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Ai4EComponentLib.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../AirPipeSim/">AirPipeSim</a></li><li><a class="tocitem" href="../CompressedAirSystem/">CompressenAirSystem</a></li><li class="is-active"><a class="tocitem" href>Electrochemistry System</a><ul class="internal"><li><a class="tocitem" href="#PhotovoltaicCell"><span>PhotovoltaicCell</span></a></li><li><a class="tocitem" href="#PEMElectrolyzer"><span>PEMElectrolyzer</span></a></li><li><a class="tocitem" href="#Lithium-battery"><span>Lithium battery</span></a></li><li><a class="tocitem" href="#Super-capacity"><span>Super capacity</span></a></li><li><a class="tocitem" href="#MPPT-Controller"><span>MPPT Controller</span></a></li></ul></li><li><a class="tocitem" href="../HVAC/">HVAC System</a></li><li><a class="tocitem" href="../IncompressiblePipe/">IncompressiblePipe System</a></li><li><a class="tocitem" href="../ThermodynamicCycle/">ThermodynamicCycle System</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../API/AirPipeSim/">AirPipeSimAPI</a></li><li><a class="tocitem" href="../../API/CompressedAirSystem/">CompressedAirSystemAPI</a></li><li><a class="tocitem" href="../../API/Electrochemistry/">ElectrochemistryAPI</a></li><li><a class="tocitem" href="../../API/HVAC/">HVACAPI</a></li><li><a class="tocitem" href="../../API/IncompressiblePipe/">IncompressiblePipeAPI</a></li><li><a class="tocitem" href="../../API/ThermodynamicCycle/">ThermodynamicCycleAPI</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Electrochemistry System</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Electrochemistry System</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ai4energy/Ai4EComponentLib.jl/blob/main/docs/src/tutorials/Electrochemistry.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Electrochemistry-System"><a class="docs-heading-anchor" href="#Electrochemistry-System">Electrochemistry System</a><a id="Electrochemistry-System-1"></a><a class="docs-heading-anchor-permalink" href="#Electrochemistry-System" title="Permalink"></a></h1><h2 id="PhotovoltaicCell"><a class="docs-heading-anchor" href="#PhotovoltaicCell">PhotovoltaicCell</a><a id="PhotovoltaicCell-1"></a><a class="docs-heading-anchor-permalink" href="#PhotovoltaicCell" title="Permalink"></a></h2><p>To use <code>PhotovoltaicCell()</code>, we design a resistor called <code>vari_Resistor</code> whose resistance value changes with time. Then we can see the I-U curve of <code>PhotovoltaicCell</code> with different loads.</p><p>Equivalent circuit diagram of <code>PhotovoltaicCell()</code>:</p><p><img src="../../assets/Electrochemistry-18-10-20.png" alt="fig_ 1"/>  </p><pre><code class="language-julia hljs">using Ai4EComponentLib
using ModelingToolkit, DifferentialEquations
using Ai4EComponentLib.Electrochemistry
using Plots

function vari_Resistor(; name)
    @named oneport = OnePort()
    @unpack v, i = oneport
    eqs = [
        v ~ i * t
    ]
    extend(ODESystem(eqs, t, [], []; name=name), oneport)
end

@named Pv = PhotovoltaicCell()
@named R = vari_Resistor()
@named ground = Ground()

eqs = [
    connect(Pv.p, R.p)
    connect(Pv.n, R.n, ground.g)
]

@named OdeFun = ODESystem(eqs, t)
@named model = compose(OdeFun, [Pv, R, ground])
sys = structural_simplify(model)
prob = ODEProblem(sys, [], (0.0, 300.0))
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: specialized 3rd order &quot;free&quot; stiffness-aware interpolation
t: 55-element Vector{Float64}:
   0.0
   1.0e-6
   1.1e-5
   0.00011099999999999999
   0.0011109999999999998
   0.011110999999999996
   0.11111099999999996
   1.1111109999999995
   6.79035935117457
   8.978148213920168
   ⋮
 159.10880840336685
 173.4801253245643
 189.1756997486783
 206.31752801865935
 225.03881424518733
 245.48515123044803
 267.81547719830417
 292.2035686705326
 300.0
u: 55-element Vector{Vector{Float64}}:
 [6.070161232179358]
 [6.070161218944301]
 [6.070161086382273]
 [6.070159760762311]
 [6.070146504594543]
 [6.070013946101201]
 [6.068688679524139]
 [6.055467772362445]
 [5.981307175281362]
 [5.921765490958639]
 ⋮
 [0.4349347898787152]
 [0.3991446222812544]
 [0.3662305704476482]
 [0.3359725683697224]
 [0.30816564410432495]
 [0.2826189866654537]
 [0.25915547745658996]
 [0.23761065441016743]
 [0.2314575832133179]</code></pre><pre><code class="language-julia hljs">plot(sol[R.p.v], sol[R.p.i], color = &quot;red&quot;)</code></pre><p><img src="../example_1.svg" alt="fig_一"/></p><h2 id="PEMElectrolyzer"><a class="docs-heading-anchor" href="#PEMElectrolyzer">PEMElectrolyzer</a><a id="PEMElectrolyzer-1"></a><a class="docs-heading-anchor-permalink" href="#PEMElectrolyzer" title="Permalink"></a></h2><p>Using above PhotovoltaicCell to drive Electrolyzer, then we build a <em>PVEL system</em>. In default paraments, we can know how the system works.</p><p>Equivalent circuit diagram of <code>PEMElectrolyzer()</code>:</p><p><img src="../../assets/Electrochemistry-18-11-06.png" alt="fig_ 2"/>  </p><pre><code class="language-julia hljs">using ModelingToolkit, DifferentialEquations
using Ai4EComponentLib
using Ai4EComponentLib.Electrochemistry

@named Pv = PhotovoltaicCell()
@named El = PEMElectrolyzer()
@named ground = Ground()
eqs = [
    connect(Pv.p, El.p)
    connect(Pv.n, El.n, ground.g)
]
@named OdeFun = ODESystem(eqs, t)
@named model = compose(OdeFun, [Pv, El, ground])
sys = structural_simplify(model)
u0 = [
    El.m_H_2 =&gt; 0.0
    El.∂_m_H_2 =&gt; 0.0
]
prob = ODEProblem(sys, u0, (0.0, 30.0))
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: specialized 3rd order &quot;free&quot; stiffness-aware interpolation
t: 29-element Vector{Float64}:
  0.0
  1.0e-6
  1.1e-5
  0.00011099999999999999
  0.0011109999999999998
  0.008439887065773926
  0.020796255796253802
  0.03442494139216535
  0.052116653461119405
  0.07210657583204284
  ⋮
  0.6700908105173512
  0.7799452514963259
  1.1065977951333883
  1.433250338770451
  2.0130301426881534
  3.83094485507726
  9.416466362176456
 28.63960936303355
 30.0
u: 29-element Vector{Vector{Float64}}:
 [0.0, 0.0, 6.063727595681834]
 [1.8307680149829605e-14, 3.6615215058424316e-8, 6.063727595681835]
 [2.2150535613568343e-12, 4.0271943799070087e-7, 6.063727595681835]
 [2.2537214333319225e-10, 4.058970969463909e-6, 6.063727595681835]
 [2.239920344148744e-8, 4.014448437387311e-5, 6.063727595681835]
 [1.2189296098963561e-6, 0.00027901338737525, 6.063727595681835]
 [6.69070409685778e-6, 0.0005882354978314793, 6.063727595681835]
 [1.6362842524229996e-5, 0.0008126644963035811, 6.063727595681835]
 [3.224746590988234e-5, 0.0009592361733792534, 6.063727595681835]
 [5.185457979379007e-5, 0.0009818115051539894, 6.063727595681835]
 ⋮
 [0.00012667436955623627, 9.372195131969263e-7, 6.063727595681835]
 [0.00012671057762334218, -3.961253864583832e-8, 6.063727595681835]
 [0.00012669665417256172, 3.353379177334356e-8, 6.063727595681835]
 [0.00012669753307424983, 1.060292541914433e-9, 6.063727595681835]
 [0.00012669772793681163, -2.6321612955817163e-10, 6.063727595681835]
 [0.0001266977465289514, 6.3591890732822245e-12, 6.063727595681835]
 [0.00012669775281945505, 8.101659530524139e-12, 6.063727595681835]
 [0.00012669775355874052, 3.3013910387812284e-13, 6.063727595681835]
 [0.00012669775357165324, 6.770560764356629e-14, 6.063727595681835]</code></pre><p>Get states of system by <code>states()</code></p><pre><code class="language-julia hljs">states(sys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{Any}:
 El₊m_H_2(t)
 El₊∂_m_H_2(t)
 El₊i(t)</code></pre><p>Check voltage, current and mass yield of electrolyzer. The working point <code>(El.v,El.i)</code> can be found in I-U curve above.</p><pre><code class="language-julia hljs">sol[El.v]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">29-element Vector{Float64}:
 2.9460329264949316
 2.9460329264949316
 2.9460329264949316
 2.9460329264949316
 2.9460329264949316
 2.9460329264949316
 2.9460329264949316
 2.9460329264949316
 2.9460329264949316
 2.9460329264949316
 ⋮
 2.9460329264949316
 2.9460329264949316
 2.9460329264949316
 2.9460329264949316
 2.9460329264949316
 2.9460329264949316
 2.9460329264949316
 2.9460329264949316
 2.9460329264949316</code></pre><pre><code class="language-julia hljs">sol[El.i]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">29-element Vector{Float64}:
 6.063727595681834
 6.063727595681835
 6.063727595681835
 6.063727595681835
 6.063727595681835
 6.063727595681835
 6.063727595681835
 6.063727595681835
 6.063727595681835
 6.063727595681835
 ⋮
 6.063727595681835
 6.063727595681835
 6.063727595681835
 6.063727595681835
 6.063727595681835
 6.063727595681835
 6.063727595681835
 6.063727595681835
 6.063727595681835</code></pre><pre><code class="language-julia hljs">sol[El.m_H_2]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">29-element Vector{Float64}:
 0.0
 1.8307680149829605e-14
 2.2150535613568343e-12
 2.2537214333319225e-10
 2.239920344148744e-8
 1.2189296098963561e-6
 6.69070409685778e-6
 1.6362842524229996e-5
 3.224746590988234e-5
 5.185457979379007e-5
 ⋮
 0.00012667436955623627
 0.00012671057762334218
 0.00012669665417256172
 0.00012669753307424983
 0.00012669772793681163
 0.0001266977465289514
 0.00012669775281945505
 0.00012669775355874052
 0.00012669775357165324</code></pre><h2 id="Lithium-battery"><a class="docs-heading-anchor" href="#Lithium-battery">Lithium battery</a><a id="Lithium-battery-1"></a><a class="docs-heading-anchor-permalink" href="#Lithium-battery" title="Permalink"></a></h2><p>Equivalent circuit diagram of <code>Lithium_ion_batteries()</code>:</p><p><img src="../../assets/ElectrochemistrySystem-3-1.png" alt="fig_ 3"/>  </p><pre><code class="language-julia hljs">using ModelingToolkit, DifferentialEquations
using Ai4EComponentLib
using Ai4EComponentLib.Electrochemistry
using Plots

@named batter = Lithium_ion_batteries()
@named Pv = PhotovoltaicCell()
@named ground = Ground()

eqs = [
    connect(batter.p, Pv.p)
    connect(batter.n, Pv.n, ground.g)
]

@named OdeFun = ODESystem(eqs, t)
@named model = compose(OdeFun, [Pv, batter, ground])
sys = structural_simplify(model)
u0 = [
    batter.v_f =&gt; 0.5
    batter.v_s =&gt; 0.5
    batter.v_soc =&gt; 0.5
]
prob = ODEProblem(sys, u0, (0.0, 3600.0))
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: specialized 3rd order &quot;free&quot; stiffness-aware interpolation
t: 37-element Vector{Float64}:
    0.0
    1.0e-6
    1.1e-5
    0.00011099999999999999
    0.0011109999999999998
    0.011110999999999996
    0.11111099999999996
    1.1111109999999995
    6.770870617087571
   16.44501650526439
    ⋮
  968.4320293753967
 1120.9138098557373
 1300.022304748988
 1514.5458506512566
 1775.8154371178352
 2103.9186860602154
 2533.885825321721
 3135.5825883010157
 3600.0
u: 37-element Vector{Vector{Float64}}:
 [0.5, 0.5, 0.5, 2.32613574386297, 6.065081346069112]
 [0.4999999977573967, 0.49999999142936485, 0.5000000000468989, 2.3261357547108465, 6.065081346025329]
 [0.4999999753313647, 0.4999999057230212, 0.500000000515888, 2.3261358628577637, 6.065081345789154]
 [0.49999975107109407, 0.4999990486603213, 0.5000000052057781, 2.3261369443261497, 6.06508134342741]
 [0.4999975084733217, 0.49999047810697717, 0.5000000521046789, 2.326147758931427, 6.065081319810146]
 [0.4999750829890147, 0.49990477993861454, 0.5000005210936259, 2.326255897126056, 6.065081083654659]
 [0.4997508774802967, 0.49904853433725055, 0.500005210977118, 2.3273364936884677, 6.065078723814942]
 [0.49751374853205843, 0.49055926276750406, 0.5000521092147455, 2.3380643519959916, 6.065055295990901]
 [0.48501942343032456, 0.4449336279755473, 0.5003175216192808, 2.396192672661811, 6.064928353592023]
 [0.4643072769626758, 0.375707928943244, 0.5007711082308799, 2.486145225306173, 6.064731912465073]
 ⋮
 [-0.048976730943765874, -0.04850134373543614, 0.5449954421454896, 3.426582748275242, 6.062678156328987]
 [-0.054295802336414935, -0.04850134760832312, 0.5520063086657062, 3.4326111087001894, 6.0626649914116415]
 [-0.05753359738678067, -0.04850127070340544, 0.5602161661800636, 3.436755324038443, 6.062655941147875]
 [-0.05931472395553959, -0.048501209860026345, 0.5700135682020963, 3.439717271192193, 6.062649472757362]
 [-0.060164695059764, -0.048501163262382053, 0.5818934240368155, 3.4421268122610127, 6.062644210728078]
 [-0.06050171231842802, -0.048501119054297104, 0.5967309882924604, 3.4445709099987347, 6.062638873232967]
 [-0.060603714417562994, -0.04850106605641416, 0.6160390603649041, 3.447589569988876, 6.062632280991217]
 [-0.060624052237255574, -0.04850099338911016, 0.6428019585357793, 3.4517338783759377, 6.0626232305241965]
 [-0.06062584866684115, -0.04850094034914864, 0.6632558164458884, 3.454737752327928, 6.062616670572666]</code></pre><pre><code class="language-julia hljs">plot(sol.t, sol[batter.v_soc], color = &quot;red&quot;)</code></pre><p><img src="../example_3_1.svg" alt="fig_3_1"/></p><pre><code class="language-julia hljs">plot(sol.t, sol[batter.v_s], color = &quot;red&quot;)</code></pre><p><img src="../example_3_2.svg" alt="fig_3_2"/></p><pre><code class="language-julia hljs">plot(sol.t, sol[batter.i_b], color = &quot;red&quot;)</code></pre><p><img src="../example_3_3.svg" alt="fig_3_3"/></p><h2 id="Super-capacity"><a class="docs-heading-anchor" href="#Super-capacity">Super capacity</a><a id="Super-capacity-1"></a><a class="docs-heading-anchor-permalink" href="#Super-capacity" title="Permalink"></a></h2><p>Equivalent circuit diagram of <code>Super_capacity()</code>:</p><p><img src="../../assets/Super_capacity_fig.png" alt="fig_ 4"/>  </p><pre><code class="language-julia hljs">using Ai4EComponentLib
using ModelingToolkit, DifferentialEquations
using Ai4EComponentLib.Electrochemistry
using Plots

function charge_controller(; name)
    @named oneport = OnePort()
    @unpack v, i = oneport
    eqs = [∂(i) ~ 0]
    events = [
        [t ~ 5.0] =&gt; [i ~ -10],
        [t ~ 36.7] =&gt; [i ~ 0],
    ]
    return extend(ODESystem(eqs, t, [], []; name=name, continuous_events=events), oneport)
end

@named ground = Ground()
@named sc = Super_capacity()
@named cg = charge_controller()
eqs = [
    connect(sc.p, cg.p)
    connect(sc.n, cg.n, ground.g)
]

@named OdeFun = ODESystem(eqs, t)
@named model = compose(OdeFun, [sc, cg, ground])
sys = structural_simplify(model)
u0 = [
    sc.v_0 =&gt; 0.0
    sc.v_2 =&gt; 0.0
    cg.i   =&gt; 0.0
]

prob = ODEProblem(sys, u0, (0.0, 600))
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: specialized 4th order &quot;free&quot; interpolation, specialized 2nd order &quot;free&quot; stiffness-aware interpolation
t: 20-element Vector{Float64}:
   0.0
   9.999999999999999e-5
   0.0010999999999999998
   0.011099999999999997
   0.11109999999999996
   1.1110999999999995
   4.999999999999999
   4.999999999999999
  14.999999999999993
  21.875164952568415
  35.28305857497855
  36.699999999999996
  36.699999999999996
  52.25812700270571
  99.90243310232333
 162.70171805985572
 244.82731082396603
 346.77342762079024
 471.5891188090726
 600.0
u: 20-element Vector{Vector{Float64}}:
 [0.0, 0.0, 0.0]
 [0.0, 0.0, 0.0]
 [0.0, 0.0, 0.0]
 [0.0, 0.0, 0.0]
 [0.0, 0.0, 0.0]
 [0.0, 0.0, 0.0]
 [0.0, 0.0, 0.0]
 [0.0, 0.0, -10.0]
 [0.9431586021499807, 0.02431537859489335, -10.0]
 [1.4797312067402217, 0.06085143042431975, -10.0]
 [2.375476261233722, 0.16863755462232197, -10.0]
 [2.46160320038797, 0.1824660046197756, -10.0]
 [2.46160320038797, 0.1824660046197756, 0.0]
 [2.449367440013306, 0.32505283742484026, 0.0]
 [2.4166812799710233, 0.7042055853858823, 0.0]
 [2.3828324347791447, 1.0940261453446694, 0.0]
 [2.350611852729195, 1.4621103035605305, 0.0]
 [2.323926709454996, 1.7641755817646896, 0.0]
 [2.3040718943375342, 1.9863247646241289, 0.0]
 [2.2923683520080207, 2.115062170647424, 0.0]</code></pre><p><img src="../../assets/Super_capacity_fig1.jpg" alt="fig_4_1"/>  </p><h2 id="MPPT-Controller"><a class="docs-heading-anchor" href="#MPPT-Controller">MPPT Controller</a><a id="MPPT-Controller-1"></a><a class="docs-heading-anchor-permalink" href="#MPPT-Controller" title="Permalink"></a></h2><p>The MPPT controller can detect the generating voltage of the solar panel in real time, and track the maximum voltage current value (VI), so that the system can charge the battery at the maximum power output.</p><p><img src="../../assets/Electrochemistry-09-45-55.png" alt="fig_ 1"/>  </p><pre><code class="language-julia hljs">using Ai4EComponentLib.Electrochemistry, Ai4EComponentLib
using ModelingToolkit
using IfElse: ifelse
using DifferentialEquations
using Plots

global power = zeros(1000).+50.0
global solar = [0.134588889,0.307388889,0.494766667,0.666464444,0.760082222,0.773202222,0.765344444,0.543993333,0.422606667,0.2673,0.1105,0.053308889,0.000384444,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.01498,0.080171111,0.229308889,0.443246667,0.607068889,0.645895556,0.729895556,0.585984444,0.644491111,0.52154,0.397646667,0.217877778,0.065024444,0.000295556,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.007548889,0.05546,0.101291111,0.19226,0.245717778,0.25434,0.275068889,0.342962222,0.288295556,0.274233333,0.172188889,0.068171111,0.027637778,0.000153333,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.019975556,0.160011111,0.312562222,0.412064444,0.493433333,0.62746,0.560811111,0.616402222,0.399442222,0.351353333,0.251548889,0.183904444,0.053468889,0.000135556,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.020437778,0.170197778,0.377557778,0.576135556,0.737717778,0.846126667,0.891886667,0.845575556,0.770962222,0.6393,0.419655556,0.241753333,0.062162222,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.01978,0.167122222,0.375406667,0.573095556,0.725095556,0.830268889,0.863833333,0.864508889,0.7793,0.63978,0.460828889,0.242908889,0.058891111,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.016508889,0.154144444,0.335015556,0.515406667,0.680544444,0.812686667,0.773504444,0.694108889,0.686997778,0.491673333,0.294624444,0.141362222,0.032402222,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.007655556,0.036668889,0.06202,0.120775556,0.115442222,0.200153333,0.171886667,0.25466,0.177664444,0.195122222,0.099797778,0.106251111,0.030731111,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.012331111,0.112331111,0.262731111,0.437095556,0.582464444,0.663815556,0.758891111,0.700508889,0.691726667,0.544348889,0.353682222,0.192864444,0.036331111,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.013397778,0.126748889,0.257344444,0.441486667,0.54266,0.632188889,0.610606667,0.552491111,0.517166667,0.453771111,0.362126667,0.187708889,0.038535556,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.011957778,0.117557778,0.292455556,0.445077778,0.562073333,0.675122222,0.757131111,0.739317778,0.588811111,0.551922222,0.379726667,0.185895556,0.037735556,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.013148889,0.124224444,0.30362,0.512171111,0.625877778,0.753255556,0.735104444,0.7321,0.617948889,0.54698,0.36842,0.173326667,0.038286667,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.012864444,0.13434,0.327051111,0.517237778,0.635335556,0.761148889,0.777415556,0.671975556,0.677948889,0.542766667,0.333771111,0.159993333,0.031033333,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.010464444,0.106002222,0.27114,0.356668889,0.509753333,0.567246667,0.599673333,0.512313333,0.336668889,0.281682222,0.209931111,0.13466,0.023264444,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.004171111,0.064811111,0.121522222,0.275264444,0.359513333,0.421184444,0.464828889,0.604953333,0.480224444,0.347797778,0.268597778,0.12666,0.026962222,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.009735556,0.099548889,0.248828889,0.333877778,0.583993333,0.662553333,0.617913333,0.497451111,0.507051111,0.359708889,0.150997778,0.057895556,0.012064444,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.002357778,0.017077778,0.04026,0.042446667,0.129077778,0.165504444,0.12458,0.122553333,0.077397778,0.083157778,0.090748889,0.097842222,0.013006667,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.004526667,0.049504444,0.142624444,0.152046667,0.283975556,0.347175556,0.317771111,0.363477778,0.210731111,0.139406667,0.097788889,0.049113333,0.012722222,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.001237778,0.017611111,0.044295556,0.083068889,0.102677778,0.226037778,0.177646667,0.12474,0.084633333,0.038624444,0.030908889,0.011477778,0.00186,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.00186,0.012775556,0.026766667,0.04106,0.056633333,0.119655556,0.070535556,0.08314,0.082304444,0.106108889,0.087762222,0.044046667,0.010482222,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.003762222,0.059673333,0.1721,0.355851111,0.40506,0.321611111,0.373077778,0.33098,0.256437778,0.221237778,0.216562222,0.098606667,0.016366667,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.007868889,0.116117778,0.303708889,0.515228889,0.660917778,0.749913333,0.751228889,0.744988889,0.637308889,0.521095556,0.339868889,0.15722,0.019726667,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.007602222,0.1281,0.338997778,0.508206667,0.643957778,0.766091111,0.820597778,0.791193333,0.459815556,0.257077778,0.246553333,0.109948889,0.011424444,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.004562222,0.078162222,0.159228889,0.236704444,0.391264444,0.434411111,0.546037778,0.540082222,0.3593,0.187477778,0.12842,0.064793333,0.006997778,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.006571111,0.116811111,0.310713333,0.493593333,0.656171111,0.754766667,0.752544444,0.681113333,0.670091111,0.501788889,0.298322222,0.130393333,0.013077778,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.006162222,0.119424444,0.311566667,0.502428889,0.66266,0.768508889,0.815068889,0.778624444,0.689024444,0.493895556,0.246411111,0.116526667,0.011068889,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.00266,0.03706,0.108971111,0.188526667,0.223495556,0.190997778,0.323353333,0.290482222,0.395246667,0.346091111,0.259904444,0.12906,0.009895556,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.00554,0.120437778,0.318677778,0.513415556,0.67194,0.766713333,0.804028889,0.774642222,0.677291111,0.528793333,0.339673333,0.140597778,0.010873333,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.005148889,0.117042222,0.31034,0.505148889,0.660775556,0.762411111,0.798553333,0.764757778,0.667673333,0.517735556,0.324828889,0.1201,0.008242222,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.003655556,0.06618,0.154855556,0.24106,0.305486667,0.30154,0.374962222,0.400295556,0.461522222,0.370464444,0.205433333,0.079904444,0.005344444,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.0001,0.002215556]
solar = solar .* 1000
@named pv_input = Secrete(solar,output_type = &quot;min&quot;)
@named power_input = Secrete(power,output_type = &quot;min&quot;)
@named pv = PhotovoltaicCell_secrete()
@named mppt = MPPT_Controller(Sampling_time = 0.5)
@named batter = Lithium_ion_batteries()
@named load = electronic_load()
@named dc_pv = DC2DC(value = 36, output_type = &quot;voltage&quot;)
@named dc_batter = DC2DC(value = 36, output_type = &quot;none&quot;)
@named ground = Ground()

eqs = [
    connect(pv_input.u, pv.u)
    connect(power_input.u, load.u)
    connect(pv.p, mppt.in.p)
    connect(pv.n, mppt.in.n)
    connect(mppt.out.p, dc_pv.in.p)
    connect(mppt.out.n, dc_pv.in.n)
    connect(dc_pv.out.p, dc_batter.out.p)
    connect(dc_pv.out.n, dc_batter.out.n)
    connect(dc_batter.in.p, batter.p)
    connect(dc_batter.in.n, batter.n)
    connect(dc_batter.out.p, load.p)
    connect(dc_batter.out.n, load.n)
    connect(pv.n, ground.g)
    connect(dc_pv.in.n, ground.g)
    connect(batter.n, ground.g)
    connect(dc_batter.out.n, ground.g)
    ]
@named OdeFun = ODESystem(eqs, t)
@named model = compose(OdeFun, [batter, ground, pv_input, power_input, pv, mppt, dc_pv, dc_batter, load])
sys = structural_simplify(model)
u0 = [
batter.v_s =&gt; 0.1,
batter.v_f =&gt; 0.1,
batter.v_soc =&gt; 0.3
    ]
prob = ODEProblem(sys, u0, (0.0,5000.0))
sol = solve(prob,Rosenbrock23())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: DtLessThanMin
Interpolation: specialized 2nd order &quot;free&quot; stiffness-aware interpolation
t: 1812-element Vector{Float64}:
   0.0
   1.0e-6
   2.3940276746839788e-6
   1.0074840885340165e-5
   2.6224468684137106e-5
   6.51026950662135e-5
   0.0001502225764140334
   0.00033457691121683696
   0.0007558942342314668
   0.0013687687314422096
   ⋮
 409.9394726422302
 409.9394726422493
 409.93947264225824
 409.9394726422625
 409.93947264226557
 409.93947264226983
 409.9394726422724
 409.9394726422738
 409.9394726422748
u: 1812-element Vector{Vector{Float64}}:
 [0.1, 0.1, 0.3, 1.0, 1.0, 1.0, 0.0, 2.4241550252162685, 2.055251654913206, 0.3898769775788612  …  0.21898188231024857, 11.83337808389856, -1.6538388262742518, 0.8361646512761751, -1.8952608458341733, 0.19359302499641975, 27.84410002592699, -2.3345690977717655, 2.0124448168433324, 4.341869158564415]
 [0.10000003054765348, 0.10000009514891682, 0.2999999928306358, 1.0, 1.0, 1.0, 0.0, -24.976824532692255, -2802.840780720509, 0.8147924258100547  …  0.814792425810055, 36.00000000000002, 0.8147924258100573, 1.0, 1.4181897804939279, -179.3229034428489, 35.99999999999998, 2802.8407807205094, -24.976824532692252, 177.904713662355]
 [0.10000005902968194, 0.10000018371961927, 0.29999998610075235, 1.0, 1.0, 1.0, 0.0, 21.02952163105448, 1797.79384760651, 0.8147924258102576  …  0.8147924258102575, 36.000000000000014, 0.8147924258102575, 1.0, -0.022633122939173314, -1.366255765949685, 36.000000000000036, -1797.7938476065103, 21.029521631054482, 1.3888888888878208]
 [0.10000001795833986, 0.10000005297142316, 0.2999999948541499, 1.0, 1.0, 1.0, 0.0, -12.698803379148883, -1575.038670917142, 0.8147924258102576  …  0.8147924258102575, 35.99999999999999, 0.8147924258102575, 1.0, -0.022633122939173814, -1.3662557659495151, 36.000000000000014, 1575.0386709171419, -12.69880337914888, 1.3888888888888884]
 [0.10000024499379136, 0.10000075741033473, 0.29999994071458824, 1.0, 1.0, 1.0, 0.0, 11.720707281953251, 866.9124903281365, 0.8147924258102576  …  0.8147924258102575, 35.99999999999999, 0.8147924258102575, 1.0, -0.022633122939173814, -1.3662557659497598, 35.99999999999999, -866.9124903281368, 11.720707281953251, 1.388888888888889]
 [0.10000021731097421, 0.10000065875193064, 0.2999999433068177, 1.0, 1.0, 1.0, 0.0, -5.52225135858909, -857.3833864553868, 0.8147924258102576  …  0.8147924258102575, 35.99999999999999, 0.8147924258102575, 1.0, -0.022633122939173814, -1.3662557659496526, 35.99999999999999, 857.3833864553869, -5.52225135858909, 1.388888888888889]
 [0.10000113624213587, 0.10000350380928069, 0.299999722236846, 1.0, 1.0, 1.0, 0.0, 6.001227008441261, 294.9648347626865, 0.8147924258102576  …  0.8147924258102575, 35.99999999999999, 0.8147924258102575, 1.0, -0.022633122939173814, -1.3662557659497039, 35.99999999999999, -294.96483476268656, 6.001227008441261, 1.388888888888889]
 [0.10000137812804413, 0.10000420208518873, 0.29999964815052244, 1.0, 1.0, 1.0, 0.0, -0.6237700643613282, -367.5347757814703, 0.8147924258102576  …  0.8147924258102575, 35.99999999999999, 0.8147924258102575, 1.0, -0.022633122939173814, -1.366255765949719, 35.99999999999999, 367.53477578147033, -0.6237700643613282, 1.388888888888889]
 [0.10000583281715461, 0.1000179912714142, 0.2999985756195344, 1.0, 1.0, 1.0, 0.0, 0.994740489261566, -205.68185665521867, 0.8147924258102576  …  0.8147924258102575, 35.99999999999999, 0.8147924258102575, 1.0, -0.022633122939173814, -1.3662557659497168, 35.99999999999999, 205.68185665521852, 0.994740489261566, 1.388888888888889]
 [0.09999981400975468, 0.09999899084891216, 0.29999990870621257, 1.0, 1.0, 1.0, 0.0, 19.59085879433298, 1653.9274229872005, 0.8147924258102576  …  0.8147924258102575, 35.99999999999999, 0.8147924258102575, 1.0, -0.022633122939173814, -1.3662557659497219, 35.99999999999999, -1653.9274229872008, 19.59085879433298, 1.388888888888889]
 ⋮
 [684.6054720752585, 2135.750555632885, -158.5053610176381, 58.40000000000056, 58.30000000000056, 252.97864117559652, 58.40000000000056, 24.046421903881935, -7.277327761040814e16, 252.98773912413532  …  4.339412334890789, 35.99999999999999, -16.619259722552503, 58.30000000000055, 26.91396782846725, -28.302856717356143, 35.99999999999999, 7.277327761040814e16, 24.046421903881935, 1.388888888888889]
 [759.9799563712711, 2371.2958190574263, -175.95315830839442, 58.40000000000056, 58.30000000000056, 252.97864117559652, 58.40000000000056, 30.259000009845355, -1.3060918612911888e17, 252.98773912413532  …  4.339412334890789, 35.99999999999999, 16.177530818666973, 58.30000000000055, -26.19861240911925, 24.809723520230346, 35.99999999999999, 1.3060918612911888e17, 30.259000009845355, 1.388888888888889]
 [820.9036304599321, 2561.6823005842375, -190.05586064373907, 58.40000000000056, 58.30000000000056, 252.97864117559652, 58.40000000000056, 45.45669896344069, -2.1212363429094317e17, 252.98773912413532  …  4.339412334890789, 35.99999999999999, 4.120889831978166, 58.30000000000055, -6.673552144564725, 5.284663255675838, 35.99999999999999, 2.1212363429094317e17, 45.45669896344069, 1.388888888888889]
 [864.1224183031837, 2696.7410125942683, -200.06020968153211, 58.40000000000056, 58.30000000000056, 252.97864117559652, 58.40000000000056, 39.18785482037654, -2.925326397481604e17, 252.98773912413532  …  4.339412334890789, 35.99999999999999, -57.56773467360318, 58.30000000000055, 93.22774809641939, -94.61663698530828, 35.99999999999999, 2.925326397481604e17, 39.18785482037654, 1.388888888888889]
 [905.9626322089144, 2827.491681049578, -209.74544438193524, 58.40000000000056, 58.30000000000056, 252.97864117559652, 58.40000000000056, 25.250967804291655, -3.888367946133848e17, 252.98773912413532  …  4.339412334890789, 34.1565973092849, 4.33941233489079, 58.30000000000055, -159.52510099743122, 156.98183393613786, 36.63662312261863, 3.888367946133848e17, 25.250967804291655, 2.543267061293322]
 [993.5833600067108, 3101.306455417544, -230.02802026105851, 58.40000000000056, 58.30000000000056, 252.97864117559652, 58.40000000000056, 28.656544648639336, -6.570825970919916e17, 252.98773912413532  …  4.339412334890789, 35.99999999999999, -59.80017757449855, 58.30000000000055, 116.25431697844121, -118.23423668098555, 3.293795352656098, 6.570825970919916e17, 28.656544648639336, 1.9799197025443518]
 [1082.7719102211395, 3380.0206748375376, -250.67351799588243, 58.40000000000056, 58.30000000000056, 252.97864117559652, 58.40000000000056, 41.570035626999946, -1.1052774229726643e18, 252.98773912413532  …  4.339412334890789, 36.00000000000008, 4.339412334890719, -1105.6567235629807, -5743.526715110264, 5742.137826221376, 24.598587201604946, 1.1052774229726643e18, 41.570035626999946, 1.3888888888888657]
 [1163.5941973404697, 3632.590322085386, -269.38238075498816, 58.40000000000056, 58.30000000000056, 252.97864117559652, 58.40000000000056, 50.04438862095322, -1.7182843382679286e18, 252.98773912413532  …  4.339412334890789, 36.0000000000004, 46.22535656736327, 58.3, 2428.870332594912, -2430.259221483802, 35.294685060733286, 1.7182843382679286e18, 50.04438862095322, 1.38888888888887]
 [1246.251002689253, 3890.892838800292, -288.51590051165203, 58.40000000000056, 58.30000000000056, 252.97864117559652, 58.40000000000056, 51.54018449446889, -2.5972101165100385e18, 252.98773912413532  …  4.339412334890789, 35.99999999999987, -407.25720951564034, 58.30000000000056, 659.5304254100325, -660.9193142989226, 43.22559898862956, 2.5972101165100385e18, 51.54018449446889, 1.3888888888888873]</code></pre><pre><code class="language-julia hljs">plot(sol.t, sol[batter.v_soc])</code></pre><p><img src="../example_mppt_v_soc.svg" alt="fig_mppt1"/></p><pre><code class="language-julia hljs">plot(sol.t, sol[mppt.p_new])</code></pre><p><img src="../example_mppt_pnew.svg" alt="fig_mppt2"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../CompressedAirSystem/">« CompressenAirSystem</a><a class="docs-footer-nextpage" href="../HVAC/">HVAC System »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Thursday 23 February 2023 13:46">Thursday 23 February 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
